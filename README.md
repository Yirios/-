# 基础生物学实验数据分析
使用Python对”基础生物学实验“的结果进行数据分析，对结果进行一步分析。
## 实验一 缓冲溶液的配制和氨基酸两性性质测定
主要对氨基酸的滴定曲线做了数学解析。

$$
K_1=\frac{[H^+][A^0]}{[A^+]}~~~~~~K_2=\frac{[H^+][A^-]}{[A^0]}
$$

$$
[A^+]+[A^0]+[A^-]=C
$$

$$
[H^+][OH^-]=K_w
$$

其中 $[A]$ 用以表示弱酸，这里就是指的甘氨酸的浓度，K_1 和 K_2 是甘氨酸的两个解离常数，C 指甘氨酸的总浓度，K_w 为水的离子积。以上四个式子已经涉及我们需要求解的 $pH$ 即 $[H^+]$,这时我们只需要引入变量即可求解 $pH-x$ 的曲线即滴定曲线。
注意到电荷守恒在加入盐酸和氢氧化钠的情况下分别有：

$$
[A^+]+[H^+]=[A^-]+[OH^-]+[Cl^-]
$$

$$
[A^+]+[H^+]=[A^-]+[OH^-]-[Na^+]
$$

这时我们就可以将 $+[Cl^-]$ 和 $-[Na^+]$ 等效为 $+x$ ，从而得到下式：

$$
[A^+]+[H^+]=[A^-]+[OH^-]+x
$$

至此我们得到了5个恒等式6个未知数组成的方程组，通过代换的方式我们可以解出 $x$ 关于 $[H^+]$ 略显复杂的函数表达式：

$$
x=(\frac{[H^+]}{K_1}-\frac{K_2}{[H^+]})\frac{C}{M}+[H^+]-\frac{K_w}{[H^+]}
$$

其中 M 为：

$$
M=\frac{[H^+]}{K_1}+\frac{K_2}{[H^+]}+1
$$

考虑到 $pH=-lg([H^+])$ , $pK_1=-lg(K_1)$ , $pK_2=-lg(K_2)$ 可以进一步写成 $x$ 关于 $pH$ 的函数表达式 $x=g(pH)$ 如下:

$$
x=g(pH)=\frac{(10^{pK1-pH}-10^{pH-pK_2})~C}{10^{pK1-pH}+10^{pH-pK_2}+1}+10^{-pH}-10^{pH-pK_w}
$$

不难发现我们所得到是 $x$ 关于 $pH$ 的函数，而滴定曲线是 $pH$ 关于 $x$ 的函数，所以我们需要进行反解以得到我们所需要的滴定曲线 $pH=f(x)$ 。然而该函数是不易反解的，注意不是不能反解只是涉及到十分冗长表达式，这是一方面原因；另一方面，我们完全可以通过对换坐标轴实现函数的翻转，并且利用隐函数求导法则我们也可以方便的求得导数关系。

## 实验二 分光光度计线性分辨范围测定---BCA和考马斯亮蓝
### 一、寻找线性范围
#### 1.滑动窗口
以下图为例，我们在选取点的时候要保证是连续的且不少于五个点，否则得出线性是无意义的。可见我们更注重的是连续点的个数，这关乎我们结果的可信度，所以采用滑动窗口的方式来查找符合 $R$ 阈值的点的个数并选取最大的。

![Alt text](result/fig/fig12.png)
滑动窗口图解：
![Alt text](sw.png)
可以结合程序运行数据理解 (__\result\process\process12.csv__) 
#### 2. $\chi^2$ 分布与综合线性浓度区间
我们现在可以通过移动窗口的方法准确的找到符合我所期望 $R$ 值的线性范围，但这是针对一组数据而言的。现在我们拥有多组数据，每一组都有其对应的线性浓度范围，这是就需要对实验结果进行综合分析，以得到合适的、准确的、可解释的线性浓度范围。这其中会遇到数据上的一些问题，这些将在下两点在做讨论。
现在，我们假设已经经数据处理得到结果较好的几组,例如：
|group|type |start|end |R         |d         |k       |
|:----:|:---:|:----:|:---:|:----:|:---:|:----:|
|2  |good   |1    |7   |0.984863  |0.013289  |3.813842|
|10 |good   |1    |8   |0.984667  |0.017288  |3.541884|
|11 |good   |1    |8   |0.986501  |0.011636  |3.679074|
|12 |good   |1    |8   |0.982340  |0.017792  |3.519576|
这4组的结果相近且符合预期，这我们设想对结果较好的组赋予较高的权重，这样对每所有组浓度范围加权求和，从而得到一个本次实验的线性浓度的概率密度函数。这里权重简单的采用高于 $R$ 阈值的量来表示, 所以浓度分布 $W$ 如下所示：


![Alt text](fb.png)

$\chi^2$ 分布可较好的体现上图所呈现的分布特征，其概率密度函数如下：

$$ 
f(x)=\left\{
\begin{aligned}
&\frac{1}{2^{\frac{n}{2}}\Gamma(\frac{n}{2})}x^{\frac{n}{2}-1}e^{-\frac{x}{2}}     &x \geqslant 0\\
&0    & x < 0\\
\end{aligned}
\right.
$$

下图为 $\chi^2$ 分布的概率密度函数的拟合效果，蓝色部分为95%置信度的线性浓度区间。
![Alt text](kf.png)
分析结果：
我们有95%的把握认为当浓度在 0.0002-0.3000 $mg/ml$ 是呈线性的。

#### 3. 数据清洗
##### 去除缺失数据
##### 舍去实验结果较不理想的组
#### 4. 规范浓度
可以明显看出5，6，8组线性部分的斜率与其他组有较大的差异，且这种差异性与线性开始组和结束组，尤其是结束组密切相关，我们猜想这样的异常是由不同的稀释方法导致的。一般情况下最好是将其舍去的，但这样的话就没几组数据了，所以考虑将其规范到相近的浓度。
观察**朗博——比尔定律**：

$$
A = \varepsilon bC
$$

对于同一温度下的同一物质，在同型号的分光机，我们可以假定 $\varepsilon$ 是常数，同时我们所使用的比色皿的厚度基本是一致的，那么实验中的 $k$ 较小就有可能是由稀释时较小的浓度梯度导致的。这样我们就可以将浓度按斜率比率缩放到合适的大小。
