# 基础生物学实验数据分析
使用Python对”基础生物学实验“的结果进行数据分析，对结果进行一步分析。
## 实验一 缓冲溶液的配制和氨基酸两性性质测定
主要对氨基酸的滴定曲线做了数学解析。

$$
K_1=\frac{[H^+][A^0]}{[A^+]}~~~~~~K_2=\frac{[H^+][A^-]}{[A^0]}
$$

$$
[A^+]+[A^0]+[A^-]=C
$$

$$
[H^+][OH^-]=K_w
$$

其中 $[A]$ 用以表示弱酸，这里就是指的甘氨酸的浓度，K_1 和 K_2 是甘氨酸的两个解离常数，C 指甘氨酸的总浓度，K_w 为水的离子积。以上四个式子已经涉及我们需要求解的 $pH$ 即 $[H^+]$,这时我们只需要引入变量即可求解 $pH-x$ 的曲线即滴定曲线。
注意到电荷守恒在加入盐酸和氢氧化钠的情况下分别有：

$$
[A^+]+[H^+]=[A^-]+[OH^-]+[Cl^-]
$$

$$
[A^+]+[H^+]=[A^-]+[OH^-]-[Na^+]
$$

这时我们就可以将 $+[Cl^-]$ 和 $-[Na^+]$ 等效为 $+x$ ，从而得到下式：

$$
[A^+]+[H^+]=[A^-]+[OH^-]+x
$$

至此我们得到了5个恒等式6个未知数组成的方程组，通过代换的方式我们可以解出 $x$ 关于 $[H^+]$ 略显复杂的函数表达式：

$$
x=(\frac{[H^+]}{K_1}-\frac{K_2}{[H^+]})\frac{C}{M}+[H^+]-\frac{K_w}{[H^+]}
$$

其中 M 为：

$$
M=\frac{[H^+]}{K_1}+\frac{K_2}{[H^+]}+1
$$

考虑到 $pH=-lg([H^+])$ , $pK_1=-lg(K_1)$ , $pK_2=-lg(K_2)$ 可以进一步写成 $x$ 关于 $pH$ 的函数表达式 $x=g(pH)$ 如下:

$$
x=g(pH)=\frac{(10^{pK1-pH}-10^{pH-pK_2})~C}{10^{pK1-pH}+10^{pH-pK_2}+1}+10^{-pH}-10^{pH-pK_w}
$$

不难发现我们所得到是 $x$ 关于 $pH$ 的函数，而滴定曲线是 $pH$ 关于 $x$ 的函数，所以我们需要进行反解以得到我们所需要的滴定曲线 $pH=f(x)$ 。然而该函数是不易反解的，注意不是不能反解只是涉及到十分冗长表达式，这是一方面原因；另一方面，我们完全可以通过对换坐标轴实现函数的翻转，并且利用隐函数求导法则我们也可以方便的求得导数关系。

## 实验二 分光光度计线性分辨范围测定---BCA和考马斯亮蓝
### 一、寻找线性范围
#### 1.滑动窗口
以下图为例，我们在选取点的时候要保证是连续的且不少于五个点，否则得出线性是无意义的。可见我们更注重的是连续点的个数，这关乎我们结果的可信度，所以采用滑动窗口的方式来查找符合 $R$ 阈值的点的个数并选取最大的。

![Alt text](result/fig/fig12.png)
滑动窗口图解：
![Alt text](sw.png)
可以结合下表的程序运行数据理解 (__\result\process\process12.csv__) :
| 起始组 | 终止组 | r                  | d                    | k                  |
|--------|--------|--------------------|----------------------|--------------------|
| 1      | 13     | 0.9247928661727085 | 0.1433499782103428   | 1.3005883207437539 |
| 1      | 12     | 0.9396169216063789 | 0.11998781735979219  | 1.507622545003237  |
| 2      | 13     | 0.9270266947162885 | 0.1636699566701909   | 1.2702746666539089 |
| 1      | 11     | 0.9418240102145368 | 0.09896936577291493  | 1.7507174762362618 |
| 2      | 12     | 0.9428413950039252 | 0.13812702943413946  | 1.4732624951293587 |
| 3      | 13     | 0.9299549709785505 | 0.18771258248683925  | 1.2347920219470598 |
| 1      | 10     | 0.954533366037502  | 0.07171456440454468  | 2.174704214157982  |
| 2      | 11     | 0.9455094910148969 | 0.11530859820903133  | 1.7081940712275157 |
| 3      | 12     | 0.9470287995411244 | 0.15966464291420346  | 1.4330534938779071 |
| 4      | 13     | 0.9323427140118447 | 0.21477281553398075  | 1.1952338923212704 |
| 1      | 9      | 0.9754466762787234 | 0.036665532494045555 | 2.9262334127254177 |
| 2      | 10     | 0.9585449924312645 | 0.08542452018245966  | 2.118228763232637  |
| 3      | 11     | 0.950405405525863  | 0.13489191564147623  | 1.658260105448155  |
| 4      | 12     | 0.9507246608069321 | 0.1836100210231254   | 1.3889173090399438 |
| 5      | 13     | 0.9371125139546645 | 0.24947925508878283  | 1.1453313122563884 |
| **1**  | **8** |==0.9823401189516285==|**0.017791706846673166**|**3.51957569913211**|
| 2      | 9      | 0.9777566350564592 | 0.046493366411390374 | 2.844763240211411  |
| 3      | 10     | 0.9642084362009266 | 0.1021680193949615   | 2.051270159165173  |
| 4      | 11     | 0.9545159307743595 | 0.15644887780548627  | 1.604272651704073  |
| 5      | 12     | 0.9575449355465344 | 0.21481689401888748  | 1.3326600209863595 |
| 6      | 13     | 0.9346149490403725 | 0.27834732319894256  | 1.1050066093853272 |
#### 2. $\chi^2$ 分布与综合线性浓度区间
我们现在可以通过移动窗口的方法准确的找到符合我所期望 $R$ 值的线性范围，但这是针对一组数据而言的。现在我们拥有多组数据，每一组都有其对应的线性浓度范围，这是就需要对实验结果进行综合分析，以得到合适的、准确的、可解释的线性浓度范围。这其中会遇到数据上的一些问题，这些将在下两点在做讨论。
现在，我们假设已经经数据处理得到结果较好的几组,例如：
|group|type |start|end |R         |d         |k       |
|:----:|:---:|:----:|:---:|:----:|:---:|:----:|
|2  |good   |1    |7   |0.984863  |0.013289  |3.813842|
|10 |good   |1    |8   |0.984667  |0.017288  |3.541884|
|11 |good   |1    |8   |0.986501  |0.011636  |3.679074|
|12 |good   |1    |8   |0.982340  |0.017792  |3.519576|
这4组的结果相近且符合预期，这我们设想对结果较好的组赋予较高的权重，这样对每所有组浓度范围加权求和，从而得到一个本次实验的线性浓度的概率密度函数。这里权重简单的采用高于 $R$ 阈值的量来表示, 所以浓度分布 $W$ 如下所示：


![Alt text](fb.png)

$\chi^2$ 分布可较好的体现上图所呈现的分布特征，其概率密度函数如下：

$$ 
f(x)=\left\{
\begin{aligned}
&\frac{1}{2^{\frac{n}{2}}\Gamma(\frac{n}{2})}x^{\frac{n}{2}-1}e^{-\frac{x}{2}}     &x \geqslant 0\\
&0    & x < 0\\
\end{aligned}
\right.
$$

下图为 $\chi^2$ 分布的概率密度函数的拟合效果，蓝色部分为95%置信度的线性浓度区间。
![Alt text](kf.png)
分析结果：
我们有95%的把握认为当浓度在 0.0002-0.3000 $mg/ml$ 是呈线性的。

#### 3. 数据清洗
##### 去除缺失数据
原始数据：
| group | 0 | 0.005 | 0.01  | 0.02  | 0.04  | 0.06  | 0.08  | 0.1   | 0.2   | 0.4   | 0.6   | 0.8   | 1     | 2     | 4     | 6     | 8     | 10    |
|-------|---|-------|-------|-------|-------|-------|-------|-------|-------|-------|-------|-------|-------|-------|-------|-------|-------|-------|
| 1     | 0 | 0.012 | 0.018 | 0.072 | 0.09  | 0.186 | 0.223 | 0.258 | 0.48  | 0.943 | 1.016 | 1.174 | 1.353 |       |       |       |       |       |
| 2     | 0 | 0.041 | 0.082 | 0.121 | 0.172 | 0.289 | 0.515 | 0.726 | 0.93  | 1.149 | 1.22  | 1.282 | 1.486 | 2.166 | 2.563 | 3.472 | 2.488 | 3.288 |
| 3     | 0 | 0.02  | 0.062 | 0.098 | 0.177 | 0.257 | 0.299 | 0.306 | 0.52  | 0.687 | 1.096 | 1.202 | 1.026 |       |       |       |       |       |
| 4     | 0 | 0.047 | 0.029 | 0.11  | 0.212 | 0.27  | 0.332 | 0.341 | 0.664 | 0.712 | 0.849 | 0.931 | 1.078 |       |       |       |       |       |
| 5     | 0 | 0.011 | 0.131 | 0.135 | 0.144 | 0.23  | 0.342 | 0.346 | 0.724 | 0.853 | 1.117 | 1.341 | 1.62  | 2.076 | 2.101 |       |       |       |
| 6     | 0 | 0.008 | 0.011 | 0.078 | 0.147 | 0.217 | 0.238 | 0.322 | 0.397 | 0.674 | 0.91  | 1.13  | 0     |       |       |       |       |       |
| 7     | 0 | 0.05  | 0.068 | 0.125 | 0.18  | 0.276 | 0.291 | 0.372 | 0.519 | 0.755 | 1.031 | 1.174 | 1.365 | 1.875 |       |       |       |       |
| 8     | 0 | 0.013 | 0.132 | 0.148 | 0.233 | 0.345 | 0.736 | 0.906 | 1.105 | 1.223 | 1.339 | 1.621 | 2.075 | 2.096 |       |       |       |       |
| 9     | 0 | 0.049 | 0.098 | 0.123 | 0.218 | 0.301 | 0.334 | 0.412 | 0.547 | 0.833 | 1.088 | 1.340 | 1.500 | 1.744 | 2.126 |       |       |       |
| 10    | 0 | 0.008 | 0.038 | 0.112 | 0.17  | 0.233 | 0.262 | 0.229 | 0.273 | 0.412 | 0.588 | 0.882 | 0.769 | 0.227 |       |       |       |       |
| 11    | 0 | 0.024 | 0.059 | 0.089 | 0.194 | 0.235 | 0.292 | 0.361 | 0.591 | 0.767 | 1.241 | 2.311 | 2.721 |       |       |       |       |       |
| 12    | 0 | 0.019 | 0.059 | 0.101 | 0.178 | 0.205 | 0.303 | 0.387 | 0.511 | 0.908 | 1.009 | 1.311 | 1.548 |       |       |       |       |       |
| 13    | 0 | 0.023 | 0.06  | 0.09  | 0.195 | 0.236 | 0.285 | 0.362 | 0.586 | 0.87  | 1.034 | 1.189 | 1.245 | 1.621 | 2.045 |       |       |       |
| 14    | 0 | 0.023 | 0.051 |       |       | 0.218 | 0.301 | 0.363 |       |       |       |       |       |       |       |       |       |       |
##### 舍去实验结果较不理想的组
舍去的组：
|group|type |start|end |R         |d         |k       |
|:----:|:---:|:----:|:---:|:----:|:---:|:----:|
|1    |bad  |2    |6   |0.974424  |0.028976  |4.149038|
|7    |bad  |8    |12  |0.959611  |0.855268  |0.913171|
|9    |bad  |2    |6   |0.964065  |0.004550  |3.987019|
保留的组：
|group|type |start|end |R         |d         |k       |
|:----:|:---:|:----:|:---:|:----:|:---:|:----:|
|0  |good   |1    |10  |0.996308  |0.013683  |2.344445|
|2  |good   |1    |7   |0.984863  |0.013289  |3.813842|
|3  |good   |4    |9   |0.985699  |0.077279  |2.930656|
|4  |good   |4    |9   |0.983343  |0.037639  |3.390328|
|**5** |good   |4    |**12**  |0.987698  |0.126748  |**1.292292**|
|**6** |good   |5    |**13**  |0.982169  |0.222313  |**1.207982**|
|**8**  |good   |4    |**13**  |0.981823  |0.216722  |**1.372357**|
|10 |good   |1    |8   |0.984667  |0.017288  |3.541884|
|11 |good   |1    |8   |0.986501  |0.011636  |3.679074|
|12 |good   |1    |8   |0.982340  |0.017792  |3.519576|
#### 4. 规范浓度
可以明显看出5，6，8组线性部分的斜率与其他组有较大的差异，且这种差异性与线性开始组和结束组，尤其是结束组密切相关，我们猜想这样的异常是由不同的稀释方法导致的。一般情况下最好是将其舍去的，但这样的话就没几组数据了，所以考虑将其规范到相近的浓度。
观察**朗博——比尔定律**：
$$
A = \varepsilon bC
$$

对于同一温度下的同一物质，在同型号的分光机，我们可以假定 $\varepsilon$ 是常数，同时我们所使用的比色皿的厚度基本是一致的，那么实验中的 $k$ 较小就有可能是由稀释时较小的浓度梯度导致的。这样我们就可以将浓度按斜率比率缩放到合适的大小。
